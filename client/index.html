<!DOCTYPE html>
<html>
<head>
	<title>Path Search</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
	<!-- Official Scrabble Player's Dictionary -->
	<script src="dictionary.js"></script>
	<script type="text/javascript">

	$(document).ready(function(){
		$('#pathSearch').submit(function() {
			$('#result').html('');
			$('#errors').html('');
			WordLadder($('#startWord').val(), $('#endWord').val());
			$('#startWord').val('');
			$('#endWord').val('');
			return false;
		});
	});

	function WordLadder(startWord, endWord) {
		// input errors
		if (startWord.length != endWord.length) { writeHTML('Words must be the same length'); }
		if (!(startWord.toLowerCase() in dictionary)) { writeHTML('errors','text-danger','"' + startWord + '"' + ' was not found in the dictionary.'); }
		if (!(endWord.toLowerCase() in dictionary)) { writeHTML('errors','text-danger','"' + endWord + '"' + ' was not found in the dictionary.'); }

		// create resource object to push used words
		var resource = {};

		// create queue for BFS and enqueue startWord
		var queue = new Queue();
		queue.enqueue(new graphNode(startWord));

		// BFS
		while (!queue.isEmpty()) {
			var node = queue.dequeue();

			if (!(node.word in resource)) {
				console.log('propogating ', node.word);
				// add node word to resource object
				resource[node.word] = null;

				// return if endWord is reached
				if (node.word == endWord.toLowerCase()) {
					return writeHTML('result', 'text-success', node.path());
				}

				// create and enqueue adjacent words
				node.adjacent = graphExtend(node.word);

				for (var i=0; i<node.adjacent.length; i++) {
					var child = new graphNode(node.adjacent[i]);
					child.parent = node;
					queue.enqueue(child);
				}
			}
		}
	}

	// substitute each character in the word all characters
	function graphExtend (word) {
		var result = [];

		for (var i=0; i<word.length; i++) {
			for (var ch=97; ch<121; ch++) {
				var child = word.substring(0,i) + String.fromCharCode(ch) + word.substring(i+1);
				if (child != word && child in dictionary) { result.push(child); }
			}
		}

		return result;
	}

	var graphNode = function(word) {
		this.word = word;
		this.parent = null;
		this.adjacent = [];

		// print path by traversing backwards
		this.path = function() {
			var path = [];
			var result = '';
			var current = this.parent;

			while(current) {
				path.push(current.word);
				current = current.parent;
			}

			for (var i=path.length-1; i>=0; i--) {
				result += path[i];
				result += ' -> ';
			}

			return result + this.word;
		};
	};

	var queueNode = function(item) {
		this.item = item;
		this.next = null;
	};

	// Queue class. enqueue to back, dequeue from front
	var Queue = function() {
		var first = null;
		var last = null;

		this.enqueue = function(item) {
			if (!first) {
				last = new queueNode(item);
				first = last;
			} else {
				last.next = new queueNode(item);
				last = last.next;
			}
		};

		this.dequeue = function() {
			if (first) {
				var item = first.item;

				first = first.next;
				if (!first) { last = null; } // if empty, empty queue

				return item;
			}
			return null;
		};

		this.isEmpty = function() {
			return (!first);
		};
	};

	function writeHTML(id, style, string) {
		$('#' + id).append('<h4 class="' + style + '">'+ string + '</h4>');
	}

	</script>
</head>
<body>
	<div class="container">
		<div class="row">
			<div class="col-xs-6">
				<h4>Construct paths from a start word to an end word where intermediate words differ by a character from their adjacent words.</h4>
				<h4>Enter two words of the same length. The algorithm references against <a href="http://www.freescrabbledictionary.com/sowpods/download/sowpods.txt">SOWPODS (Europe Scrabble Word List)</a>, so some words may not be valid due to obscurity or existing in a different form.</h4>
				<h4>View source for the code.</h4>

				<!-- positive test case: "tame", "rent" -->
				<!-- negative test case: "bridal", "batter" -->
				<!-- corner case: "dog", "dog" -->
				<!-- corner case: "sent", "rent" -->
				<form id="pathSearch">
					<div id="errors"></div>

					<div class="form-group">
						<label>Start Word:</label>
						<input class="form-control" id="startWord" type="text">
					</div>

					<div class="form-group">
						<label>End Word:</label>
						<input class="form-control" id="endWord" type="text">
					</div>

					<input class="form-control" type="submit">
				</form>
			</div>

			<div id="result" class="col-xs-6"></div>
		</div>
	</div>
</body>
</html>
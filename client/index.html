<!DOCTYPE html>
<html>
<head>
  <title>Path Search</title>
  <!-- Latest compiled and minified jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
  <!-- Style sheet -->
  <link rel="stylesheet" type="text/css" href="style.css">
  <!-- Latest compiled and minified D3js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
  <!-- Official Scrabble Player's Dictionary -->
  <script src="dictionary.js"></script>
  <script src="queue.js"></script>
  <script src="graph.js"></script>
  <script type="text/javascript">

  $(document).ready(function(){
    $('#wordLadder').submit(function() {
      $('#result').html('');
      $('#errors').html('');
      WordLadder($('#startWord').val(), $('#endWord').val());
      return false;
    });

    $('#graphDraw').submit(function() {
      graphDraw($('#startWord').val(), $('#endWord').val());
      return false;
    });

    // 'cat'/'dog' example
    $('#startWord').val('cat');
    $('#endWord').val('dog');
    WordLadder('cat', 'dog');
    graphDraw('cat', 'dog');
  });

  // main problem-solving function
  function WordLadder(startWord, endWord) {
    startWord = startWord.toLowerCase();
    endWord = endWord.toLowerCase();

    // input errors
    if (startWord.length != endWord.length) { return writeHTML('errors','text-danger','Words must be the same length'); }
    if (!(startWord in dictionary)) { return writeHTML('errors','text-danger','"' + startWord + '"' + ' was not found in the dictionary.'); }
    if (!(endWord in dictionary)) { return writeHTML('errors','text-danger','"' + endWord + '"' + ' was not found in the dictionary.'); }

    // create object to push used words
    var usedWords = {};

    // create queue for BFS and enqueue startWord
    var queue = new Queue();
    queue.enqueue(new graphNode(startWord));

    // BFS
    while (!queue.isEmpty()) {
      var node = queue.dequeue();

      // return if endWord is reached
      if (node.word == endWord) {
        return writeHTML('result', 'text-success', node.path());
      }

      if (!(node.word in usedWords)) {
        // add node word to resource object
        usedWords[node.word] = null;

        // create and enqueue adjacent words
        var children = graphExtend(node.word);

        for (var i=0; i<children.length; i++) {
          var child = new graphNode(children[i]);
          child.parent = node; // set child's parent
          node.adjacent.push(child); // update array of parent's adjacent nodes
          queue.enqueue(child);
        }
      }
    }

    // return only if search was unsuccessful
    return writeHTML('result', 'text-danger', 'No paths exist between these two words.');
  }

  // substitute each character in the word all characters
  function graphExtend (word) {
    var result = [];

    for (var i=0; i<word.length; i++) {
      for (var ch=97; ch<121; ch++) {
        var child = word.substring(0,i) + String.fromCharCode(ch) + word.substring(i+1);
        if (child != word && child in dictionary) { result.push(child); }
      }
    }

    return result;
  }

  // graph item
  var graphNode = function(word) {
    this.word = word;
    this.parent = null;
    this.adjacent = [];

    // print path by traversing backwards
    this.path = function() {
      var path = [];
      var result = '';
      var current = this.parent;

      while(current) {
        path.push(current.word);
        current = current.parent;
      }

      for (var i=path.length-1; i>=0; i--) {
        result += path[i];
        result += ' -> ';
      }

      return result + this.word;
    };
  };

  // function to write HTML content
  function writeHTML(id, style, string) {
    $('#' + id).append('<h4 class="' + style + '">'+ string + '</h4>');
  }

  </script>
</head>
<body>
  <div class="container-fluid">
    <div class="row">
      <div id="left-column" class="col-sm-3">
        <h4>Author: <a href="https://www.linkedin.com/in/tlpham88">Tienlong Pham</a></h4>
        <h4>Github: <a href="https://github.com/aglorei88/">AGLOREI</a></h4>
        <h4>Construct paths from a start word to an end word where intermediate words differ by a character from their adjacent words. Based on Lewis Carroll's <a href="http://en.wikipedia.org/wiki/Word_ladder">Word Ladder</a> game.</h4>
        <h4>Enter two words of the same length. The algorithm references against <a href="http://www.freescrabbledictionary.com/sowpods/download/sowpods.txt">SOWPODS (Europe Scrabble Word List)</a>. The algorithm will draw the shortest existing path between the two words.</h4>
        <h4>The graphing algorithm uses <a href="http://d3js.org">D3.js</a> to visually render edges between all words of the same length. Singletons are not included for the sake of conserving client-side resources.</h4>
        <h4>View source for the code.</h4>
        <h4>Examples:</h4>
        <ul>
          <li>positive test case: "tame", "rent"</li>
          <li>negative test case: "batter", "bridal"</li>
          <li>corner case: "dog", "dog"</li>
          <li>corner case: "sent", "rent"</li>
          <li>graphing case: "percolations", "acclimatizes"</li>
        </ul>

        <div id="errors"></div>

        <div class="form-group">
          <label>Start Word:</label>
          <input class="form-control" id="startWord" type="text">
        </div>

        <div class="form-group">
          <label>End Word:</label>
          <input class="form-control" id="endWord" type="text">
        </div>

        <form id="wordLadder">
          <input class="form-control" type="submit" value="Generate Path">
        </form>
        <form id="graphDraw">
          <p class="text-danger">Warning: running the below graph drawing where 4 < word length < 10 will strain resources (length 4 creates over 19,000 svg elements).</p>
          <input class="form-control" type="submit" value="Generate Graph">
        </form>
      </div>

      <div id="result" class="col-sm-9"></div>
    </div>
  </div>
</body>
</html>
